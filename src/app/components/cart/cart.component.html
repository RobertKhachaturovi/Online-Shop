<div class="checkout-animation-overlay" *ngIf="showCheckoutAnimation">
    <div class="checkout-animation-container" (click)="$event.stopPropagation()">
        <div class="checkout-line"></div>
        <div class="checkout-photo">
            <img src="https://png.pngtree.com/png-vector/20250607/ourmid/pngtree-realistic-3d-shopping-cart-with-product-boxes-for-e-commerce-and-png-image_16486581.png"
                alt="Checkout Animation" />
        </div>
        <div class="checkout-text">
            <mat-icon>shopping_bag</mat-icon>
            <span>{{ 'ORDER_PLACED' | translate }}</span>
            <div class="subtitle">{{ 'ORDER_SUBMITTED' | translate }}</div>
        </div>
        <div class="checkout-confetti">
            <div class="confetti-piece" *ngFor="let piece of confettiPieces" [style.--color]="piece.color"
                [style.--left]="piece.left + '%'" [style.--delay]="piece.animationDelay + 's'">
            </div>
        </div>
    </div>
</div>


<div class="remove-animation-overlay" *ngIf="showRemoveAnimation" (click)="closeRemoveAnimation()">
    <div class="remove-animation-container" (click)="$event.stopPropagation()">
        <div class="remove-line"></div>
        <div class="remove-photo">
            <img src="https://cdn-icons-png.flaticon.com/512/6861/6861362.png" alt="Remove Animation" />
        </div>
        <div class="remove-text">
            <mat-icon>delete_forever</mat-icon>
            <span>{{ 'ITEM_REMOVED' | translate }}</span>
            <div class="subtitle">{{ 'PRODUCT_REMOVED' | translate }}</div>
        </div>
    </div>
</div>

<div class="reset-animation-overlay" *ngIf="showResetAnimation" (click)="closeResetAnimation()">
    <div class="reset-animation-container" (click)="$event.stopPropagation()">
        <div class="reset-line"></div>
        <div class="reset-photo">
            <img src="https://cdn-icons-png.flaticon.com/512/6861/6861362.png" alt="Reset Animation" />
        </div>
        <div class="reset-text">
            <mat-icon>clear_all</mat-icon>
            <span>{{ 'CART_CLEARED' | translate }}</span>
            <div class="subtitle">{{ 'ALL_ITEMS_REMOVED' | translate }}</div>
        </div>
    </div>
</div>

    <div *ngIf="cartItems && cartItems.length > 0">
    <div class="cart-container">
        <h2>{{ 'CART_TITLE' | translate }}</h2>
        <ul>
            <li *ngFor="let item of cartItems" class="cart-item">

                <img [src]="item.product?.images?.[0] || 'https://via.placeholder.com/60x60?text=No+Image'"
                    [alt]="item.product?.title || ('PRODUCT_IMAGE_NOT_AVAILABLE' | translate)"
                    style="font-size: 10px;  text-align: center;" class="cart-img" />

                <div>
                    <div class="cart-model">
                        <span class="cart-model-label">{{ 'MODEL' | translate }}</span>
                        <span class="cart-model-value">{{ item.product?.title }}</span>
                    </div>
                    <div class="cart-qty-control">
                        <button class="qty-btn" (click)="updateCartQuantity(item, item.quantity - 1)"
                            [disabled]="item.quantity <= 1">-</button>
                        <span class="qty-value">{{ item.quantity }}</span>
                        <button class="qty-btn" (click)="updateCartQuantity(item, item.quantity + 1)">+</button>
                    </div>
                    <div class="cart-qty">
                        {{ 'UNIT_PRICE' | translate }} {{ item.product?.price?.current || item.product?.price }} ₾
                    </div>
                    <div class="cart-total">
                        {{ 'TOTAL_PRICE' | translate }} {{ (item.quantity * (item.product?.price?.current || item.product?.price)) |
                        number:'1.0-0' }} ₾
                    </div>
                </div>
                <button (click)="removeFromCart(item.product)">{{ 'REMOVE' | translate }}</button>
            </li>
        </ul>

        <div class="cart-summary">
            <span>{{ 'FULL_TOTAL_PRICE' | translate }}</span>
            <span class="cart-summary-total">{{ cartTotal | number:'1.0-0' }} ₾</span>
        </div>

        <button class="reset-cart-btn" (click)="resetCart()">{{ 'RESET_CART' | translate }}</button>
        <button class="checkout-btn" (click)="openPaymentModal()" [disabled]="!cartItems.length">{{ 'CHECK_OUT' | translate }}</button>

        <button class="print-receipt-btn" (click)="printReceipt()" [disabled]="!cartItems.length">{{ 'PRINT_RECEIPT' | translate }}</button>
    </div>
</div>
<div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>{{ 'LOADING' | translate }}</p>
</div>

<div *ngIf="!loading && cartItems && cartItems.length === 0" class="cart-empty-block">
    <img src="https://cdn-icons-png.flaticon.com/512/11329/11329060.png" alt="Empty cart" class="cart-empty-img" />
    <div class="cart-empty-text">{{ 'CART_EMPTY' | translate }} <span class="cart-empty-red">{{ 'CART_EMPTY_RED' | translate }}</span></div>
</div>